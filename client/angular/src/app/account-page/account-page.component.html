<!--{{ backend.userAccount | stringify }}-->

<app-content-width>

    <div style="height: 150px;"></div>

    <div *ngIf="backend.userAccount">

        <h1>Your articles have been read {{ backend.userAccount.totalViews}} times in total.</h1>

        <div>

            You are logged in with {{ backend.userAccount.email }}
            <span *ngIf="backend.userAccount.verified">(verified / maybe not)</span>

            <a href="#" (click)="backend.logoutUser()" [ngStyle]="{background: 'darkred', color: 'white', padding: '10px 20px'}" style="display: inline-block;">Log Out</a>


            <h3>You have {{ backend.userAccount.authors.length }} authors</h3>
            <div *ngFor="let author of backend.userAccount.authors">
                <h1 [routerLink]="['/',author.id]">{{ author.name }}</h1>
                <img [src]="author.imageURL + '&w=100&h=100'" />

                <div (click)="saveAuthorOrder(author)">save order</div>


                <!-- test publication sort! -->
                <h4>sortable everything!</h4>
                <!-- copy -->
                <div dnd-sortable-container [sortableData]="author.publications" [dropZones]="['container-dropZone']">
                    <div class="col-sm3" *ngFor="let publication of author.publications; let i = index" dnd-sortable [sortableIndex]="i" [dragEnabled]="sortable === 'publication'">
                        <div class="panel panel-warning" dnd-sortable-container [sortableData]="publication.articles" [dropZones]="['widget-dropZone']">
                            <div class="panel-heading" (mouseenter)="sortable = 'publication'" (mouseleave)="sortable = 'article'">
                                <h3 [routerLink]="['/', publication.author.id, publication.id]">{{ publication.name }}</h3>
                                <img [src]="publication.imageURL + '&w=700&h=100'" />
                            </div>
                            <div class="panel-body">
                                <div class="list-group">
                                    <div *ngFor="let article of publication.articles; let x = index" class="list-group-item" dnd-sortable [sortableIndex]="x"
                                        [dragEnabled]="sortable === 'article'" [dragData]="article">
                                        <a [routerLink]="['/', article.publication.author.id, article.publication.id, article.id]">{{ article.title }}</a>
                                    </div>
                                    <!-- new article in publication -->
                                    <a [routerLink]="['/', publication.author.id, publication.id, 'create-article']">new article!</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <a [routerLink]="['/', author.id, 'create-publication']">create publication by {{ author }}</a>
            </div>



            <br>
            <a [routerLink]="['/create-author']" [ngStyle]="{background: '#222', color: 'white', padding: '10px 20px'}" style="display: inline-block;">
        Create New Author
        </a>
        </div>



    </div>

    

    <h2><a [routerLink]="['/my-media']">Your Media</a></h2>

    <flex-row style="overflow-y: scroll;">
        <flex-col *ngFor="let image of backend.userImages | slice:0:20">
            <img [src]="image.url + '&w=200&h=200'" style="margin:5px;" />
            <button (click)="backend.deleteImage(image.id)">delete</button>
        </flex-col>
    </flex-row>



</app-content-width>

<div style="height: 100px"></div>